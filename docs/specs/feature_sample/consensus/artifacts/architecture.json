{
  "epic_id": "EP-SAMPLE",
  "version": "1.0",
  "created_by": "architect",
  "created_at": "2025-12-27",
  "components": [
    {
      "name": "UserProfile",
      "layer": "domain",
      "description": "Entity representing user profile data",
      "ports": [],
      "dependencies": []
    },
    {
      "name": "ProfileValidation",
      "layer": "domain",
      "description": "Validation rules for profile fields",
      "ports": [],
      "dependencies": []
    },
    {
      "name": "GetProfileUseCase",
      "layer": "application",
      "description": "Use case for retrieving user profile",
      "ports": ["ProfileRepositoryPort", "AuthorizationPort"],
      "dependencies": ["UserProfile"]
    },
    {
      "name": "UpdateProfileUseCase",
      "layer": "application",
      "description": "Use case for updating user profile",
      "ports": ["ProfileRepositoryPort", "AuthorizationPort"],
      "dependencies": ["UserProfile", "ProfileValidation"]
    },
    {
      "name": "ProfileRepositoryPort",
      "layer": "application",
      "description": "Interface for profile data storage",
      "ports": [],
      "dependencies": []
    },
    {
      "name": "AuthorizationPort",
      "layer": "application",
      "description": "Interface for authorization checks",
      "ports": [],
      "dependencies": []
    },
    {
      "name": "ProfileRepositoryAdapter",
      "layer": "infrastructure",
      "description": "Database implementation of ProfileRepositoryPort",
      "ports": [],
      "dependencies": ["ProfileRepositoryPort"]
    },
    {
      "name": "AuthorizationAdapter",
      "layer": "infrastructure",
      "description": "Auth service implementation of AuthorizationPort",
      "ports": [],
      "dependencies": ["AuthorizationPort"]
    },
    {
      "name": "ProfileController",
      "layer": "presentation",
      "description": "HTTP request handler for profile endpoints",
      "ports": [],
      "dependencies": ["GetProfileUseCase", "UpdateProfileUseCase"]
    },
    {
      "name": "ProfileRoutes",
      "layer": "presentation",
      "description": "Route definitions for profile API",
      "ports": [],
      "dependencies": ["ProfileController"]
    }
  ],
  "boundaries": {
    "domain_to_application": "Domain entities used by use cases",
    "application_to_infrastructure": "Ports implemented by adapters",
    "infrastructure_to_presentation": "Use cases injected into controllers"
  },
  "contracts": {
    "ProfileRepositoryPort": {
      "methods": [
        "findById(userId: string): Promise<UserProfile | null>",
        "update(userId: string, data: ProfileUpdateData): Promise<UserProfile>"
      ]
    },
    "AuthorizationPort": {
      "methods": [
        "canViewProfile(requesterId: string, targetId: string): Promise<boolean>",
        "canEditProfile(requesterId: string, targetId: string): Promise<boolean>"
      ]
    }
  },
  "data_flows": [
    {
      "name": "Get Profile",
      "flow": ["ProfileRoutes", "ProfileController", "GetProfileUseCase", "AuthorizationPort", "ProfileRepositoryPort"]
    },
    {
      "name": "Update Profile",
      "flow": ["ProfileRoutes", "ProfileController", "UpdateProfileUseCase", "AuthorizationPort", "ProfileValidation", "ProfileRepositoryPort"]
    }
  ],
  "risks": [
    {
      "risk": "Database connection timeout",
      "impact": "High",
      "mitigation": "Connection pooling, timeout configuration, retry logic"
    },
    {
      "risk": "Auth service unavailability",
      "impact": "High",
      "mitigation": "Circuit breaker, fail closed (deny access)"
    }
  ],
  "decisions": [
    {
      "id": "ADR-001",
      "title": "Use port/adapter pattern for repository",
      "rationale": "Enables testing with mocks, allows switching storage implementations"
    },
    {
      "id": "ADR-002",
      "title": "Authorization at use case level",
      "rationale": "Ensures all entry points are protected, not just HTTP"
    }
  ]
}
