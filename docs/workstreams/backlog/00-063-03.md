---
ws_id: "00-063-03"
feature_id: "F063"
title: "Guard Configuration and Gate Alignment"
status: "backlog"
priority: "P1"
depends_on: ["00-063-01"]
blocks: ["00-063-04"]
project_id: "00"
---

# 00-063-03: Guard Configuration and Gate Alignment

## Goal

Introduce dedicated guard rules config and align guard/quality expectations across CLI, docs, and CI.

## Context

Rules need independent lifecycle and clean structure. Also current thresholds and behavior differ between documentation and actual checks.

## Source of inspiration

- [guardian-cli example rules config](https://github.com/AlexGladkov/guardian-cli/blob/main/examples/.agreements/rules.yml)
- [guardian-cli constitution config](https://github.com/AlexGladkov/guardian-cli/blob/main/examples/.agreements/constitution.yml)
- [guardian-cli rule checker registry](https://github.com/AlexGladkov/guardian-cli/blob/main/internal/engine/checker.go)

## Acceptance Criteria

- [ ] AC1: `.sdp/guard-rules.yml` is supported as canonical rules source
- [ ] AC2: Rule schema/validation errors are explicit and actionable
- [ ] AC3: `.sdp/config.yml` references guard policy settings (mode, severity mapping)
- [ ] AC4: Documentation clearly defines local vs CI behavior and exit codes
- [ ] AC5: CI workflow consumes the same rule source as local runs
- [ ] AC6: No duplicate rule definitions between docs and runtime defaults

## Scope Files

**Implementation:**
- sdp-plugin/internal/config/project.go (update)
- sdp-plugin/internal/config/project_test.go (update)
- sdp-plugin/internal/guard/state.go (update if config path handling needed)
- .sdp/config.yml (update defaults/references)
- docs/reference/configuration.md (update)
- docs/reference/quality-gates.md (update)
- .github/workflows/go-ci.yml (update)

**Tests:**
- sdp-plugin/internal/config/project_test.go (update)

## Notes

- ~1.5h work
- Keep migration path simple for repos without `.sdp/guard-rules.yml`
