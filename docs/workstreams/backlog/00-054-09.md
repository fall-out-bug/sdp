---
ws_id: "00-054-09"
feature_id: "F054"
title: "Dogfooding & Integration"
status: "backlog"
priority: "P0"
depends_on: ["00-054-05", "00-054-06", "00-054-07", "00-054-08", "00-054-11"]
blocks: []
project_id: "00"
---

# 00-054-09: Dogfooding & Integration

## Goal

End-to-end integration test: use the evidence layer to build the evidence layer. Prove it works on SDP itself.

## Context

Best proof: F054 builds itself with F054 instrumented. After this WS, every subsequent `@build` on SDP emits evidence, runs acceptance tests, and supports `sdp log trace`.

## Acceptance Criteria

- [ ] AC1: `.sdp/config.yml` configured for SDP project itself
- [ ] AC2: Acceptance test: `go test ./... -run TestSmoke` passes
- [ ] AC3: `@build 00-054-09` generates at least 4 evidence events in `.sdp/log/events.jsonl`
- [ ] AC4: `sdp log trace` shows the chain for this build
- [ ] AC5: `sdp collision check` runs without error on current workstreams
- [ ] AC6: Evidence log committed to repo
- [ ] AC7: `sdp log trace --verify` shows intact chain
- [ ] AC8: Documentation: update CLAUDE.md with evidence layer usage

## Scope Files

**Implementation:**
- .sdp/config.yml (new — project config for SDP itself)
- .sdp/log/events.jsonl (generated by build)
- .gitattributes (update — merge driver for evidence log)
- CLAUDE.md (update — document new commands)

**Tests:**
- sdp-plugin/internal/evidence/integration_test.go (new — E2E test)

## Integration Test

```go
func TestEvidenceLayerE2E(t *testing.T) {
    // 1. Create temp project with config
    // 2. Write evidence events (plan, generation, verification, approval)
    // 3. Read and verify chain integrity
    // 4. Run trace command, verify output
    // 5. Check collision detection with overlapping WS
}
```

## Verification

```bash
# Full integration
cd sdp-plugin && go test ./internal/evidence/... -run TestE2E -v
# Acceptance gate on SDP itself
sdp acceptance run
# Trace the current build
sdp log trace --ws 00-054-09
```

## Notes

- ~2h work
- This is the capstone — everything comes together
- After this, SDP eats its own dog food
- Update CLAUDE.md: add `sdp log trace`, `sdp acceptance run`, `sdp collision check`
- Update @build skill to mention evidence emission
