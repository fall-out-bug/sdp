---
ws_id: 00-067-13
feature_id: F067
title: "Skill and Agent Optimization (Size Reduction, Versioning)"
status: backlog
priority: 2
size: MEDIUM
depends_on: [00-067-02]
blocks: [00-067-08]
project_id: sdp
---

## Goal

Reduce large skill file sizes, add consistent version headers to all agent definitions, and establish skill size guidelines.

## Context

**Large skills consume context window**: Some skills are very large:
- `reality/SKILL.md` — 703 lines
- `review/SKILL.md` — 697 lines
- `prototype/SKILL.md` — 597 lines
- `build/SKILL.md` — 438 lines

When agents load these skills, they consume significant context window. Smaller, composable skills would be more efficient.

**Inconsistent agent versioning**: Some agents have frontmatter with version (`orchestrator.md: version: 2.2.0`), others have none. No mechanism to check version compatibility or track changes.

## Acceptance Criteria

- [ ] AC1: Establish skill size guideline (target: <=300 lines per SKILL.md)
- [ ] AC2: Split skills >500 lines into base + extension files
- [ ] AC3: Add consistent frontmatter to all agent definitions in `prompts/agents/`
- [ ] AC4: All agents include: name, description, version, changes fields
- [ ] AC5: Create agent version index (`prompts/agents/VERSIONS.md`)
- [ ] AC6: Document skill composition pattern (how to reference sub-skills)
- [ ] AC7: No skill file exceeds 500 lines after optimization

## Scope Files

```yaml
scope_files:
  # Large skills to split
  - prompts/skills/reality/SKILL.md        # 703 lines
  - prompts/skills/review/SKILL.md         # 697 lines
  - prompts/skills/prototype/SKILL.md      # 597 lines

  # Agent versioning
  - prompts/agents/*.md                    # add version frontmatter
  - prompts/agents/VERSIONS.md             # NEW — version index

  # Documentation
  - docs/reference/skills.md               # update with size guidelines
```

## Implementation Notes

### Skill Splitting Pattern

```
reality/SKILL.md (703 lines) →
  reality/SKILL.md           (200 lines) — core workflow + invocation
  reality/agents.md          (150 lines) — 8 agent definitions
  reality/output-format.md   (150 lines) — output templates
  reality/examples.md        (200 lines) — usage examples
```

The main SKILL.md includes references: `See ./agents.md for agent details.`

### Agent Frontmatter Template

```yaml
---
name: architect
description: System architecture analysis and design decisions
version: 1.0.0
changes:
  - Initial version
---
```

### Version Index

```markdown
# Agent Versions

| Agent | Version | Last Updated |
|-------|---------|-------------|
| orchestrator | 2.2.0 | 2026-02-13 |
| architect | 1.0.0 | 2026-02-13 |
| ... | ... | ... |
```

## Definition of Done

- [ ] No skill exceeds 500 lines
- [ ] All agents have version frontmatter
- [ ] Version index published
- [ ] AC1-AC7 met
