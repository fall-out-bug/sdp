---
ws_id: 00-050-05
parent: sdp-79u
feature: F050
status: backlog
size: MEDIUM
project_id: 00
---

# Depends handled by parent epic sdp-79u
---

## WS-00-050-05: Quality Gates (Extend sdp doctor)

### ðŸŽ¯ Goal

Extend `sdp doctor` command with quality checks: coverage, complexity, file size, type hints. Provides automated quality validation.

**What must WORK after completing this WS:**
- Coverage checker (â‰¥80%)
- Complexity analyzer (CC < 10)
- File size validator (<200 LOC)
- Type completeness check
- Integration with `sdp doctor`
- Commands: `sdp quality coverage/complexity/size`

**Acceptance Criteria:**
- [ ] AC1: Coverage â‰¥80% check (pytest/go test/mvn)
- [ ] AC2: Cyclomatic complexity <10
- [ ] AC3: File size <200 LOC
- [ ] AC4: Type completeness (Python: mypy, Go: vet)
- [ ] AC5: Integrated into `sdp doctor`
- [ ] AC6: Commands work: `sdp quality coverage/complexity/size`
- [ ] Coverage â‰¥ 80%

**âš ï¸ WS is NOT complete until Goal is achieved (all AC âœ…).**

---

### ðŸ“‹ Contracts

**Technical Constraints:**
- Must detect project type (Python/Go/Java)
- Must run appropriate tools (pytest, go test, mvn)
- Must parse coverage reports
- Must analyze AST for complexity

**Builds on F041:**
- âœ… `sdp-plugin/internal/doctor/` exists (from F041-05)
- âœ… `sdp doctor` command exists (from F041-05)
- ðŸ†• Add quality checks to existing doctor

---

### ðŸ”Œ Interfaces

```go
package quality

type Checker struct {
    projectPath string
    projectType Type
}

type Type int

const (
    Python Type = iota
    Go
    Java
)

func (c *Checker) CheckCoverage() (*CoverageResult, error)
func (c *Checker) CheckComplexity() (*ComplexityResult, error)
func (c *Checker) CheckFileSize() (*FileSizeResult, error)
func (c *Checker) CheckTypes() (*TypeResult, error)
```

---

### ðŸ“ Scope Files

**Implementation:**
- `internal/quality/checker.go` (NEW)
- `internal/quality/coverage.go` (NEW)
- `internal/quality/complexity.go` (NEW)
- `internal/quality/size.go` (NEW)
- `internal/quality/types.go` (NEW)
- `internal/doctor/doctor.go` (ENHANCE)
- `cmd/sdp/quality.go` (NEW)

**Tests:**
- `internal/quality/checker_test.go` (NEW)

---

### âœ… Testing

**Unit Tests:**
```bash
TestCheckCoveragePython()
TestCheckCoverageGo()
TestCheckComplexity()
TestCheckFileSize()
```

**Integration Tests:**
```bash
cd sdp-plugin
go test ./internal/quality/... -v
./sdp quality coverage
./sdp doctor  # Should include quality checks
```

---

### ðŸ“ Notes

**Dependencies:** None

**Context:**
Quality gates enforce SDP standards. F041 created basic doctor, we extend with comprehensive checks.

**Integration:**
- Used by: @review skill, `sdp doctor`
- Provides: Automated quality validation
