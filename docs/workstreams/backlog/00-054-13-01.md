---
ws_id: "00-054-13"
feature_id: "F054"
title: "EmitLesson Writes to Evidence Log"
status: "backlog"
priority: "P1"
depends_on: ["00-054-04"]
blocks: []
project_id: "00"
---

# 00-054-13: EmitLesson Writes to Evidence Log

## Goal

### ðŸŽ¯ Goal

Fix EmitLesson so lesson events are written to `.sdp/log/events.jsonl`. (F054-BUG sdp-sswq: EmitLesson was a no-op stub.)

## Acceptance Criteria

- [x] AC1: `EmitLesson(lesson)` writes a `lesson` event to the evidence log when evidence is enabled
- [x] AC2: Event has type `lesson`, ws_id from lesson.WSID, and data matching LessonEventData (category, insight, source_ws_id, outcome, related_decisions)
- [x] AC3: Outcome mapped: passedâ†’worked, failedâ†’failed, mixedâ†’mixed
- [x] AC4: Stale TODO removed from lessons.go
- [x] AC5: Test(s) verify lesson event is written (e.g. with Enabled config)

## Scope Files

**Implementation:**
- sdp-plugin/internal/evidence/lessons.go
- sdp-plugin/internal/evidence/emitter.go (add LessonEvent helper if needed)

**Tests:**
- sdp-plugin/internal/evidence/lessons_test.go

## Verification

```bash
cd sdp-plugin && go test ./internal/evidence/... -run Lesson -cover -count=1
```

## Notes

- Beads task: sdp-sswq

---

## Execution Report

**Build:** 00-054-13 (sdp-sswq)  
**Date:** 2026-02-09

### Steps

1. Pre-build: `hooks/pre-build.sh 00-054-13` â€” PASSED
2. Guard: `sdp guard activate 00-054-13` â€” activated
3. TDD: Added `LessonEvent(lesson)` in emitter.go; `EmitLesson` now calls `EmitSync(LessonEvent(lesson))` when Enabled; removed stale TODO; tests `TestLessonEvent`, `TestEmitLesson_WritesWhenEnabled`
4. Post-build: skipped (no poetry)

### Results

- **Coverage:** 85.1% (evidence package)
- **Verdict:** âœ… COMPLETE
