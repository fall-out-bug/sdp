---
ws_id: "00-054-12"
feature_id: "F054"
title: "Evidence Package Coverage to 80%"
status: "backlog"
priority: "P1"
depends_on: ["00-054-10"]
blocks: []
project_id: "00"
---

# 00-054-12: Evidence Package Coverage to 80%

## Goal

### ðŸŽ¯ Goal

Raise `internal/evidence` test coverage from 74% to â‰¥80% by adding tests for Emit, EmitSync, keyData, and appendToFile. (Follow-up from @review F054 â€” sdp-8y0y.)

## Acceptance Criteria

- [x] AC1: Test(s) cover `Emit` or `EmitSync` so emission path is exercised
- [x] AC2: Test(s) cover `keyData` for decision and gate_name/model_id branches
- [x] AC3: Test(s) cover `appendToFile` error paths (write/fsync failure) or Writer.Append error path
- [x] AC4: `go test ./internal/evidence/... -cover` reports â‰¥80% statements
- [x] AC5: All existing tests still pass

## Scope Files

**Implementation:**
- sdp-plugin/internal/evidence/emitter_test.go
- sdp-plugin/internal/evidence/tracer_test.go
- sdp-plugin/internal/evidence/writer_test.go

## Verification

```bash
cd sdp-plugin && go test ./internal/evidence/... -cover -count=1
# total coverage â‰¥ 80%
```

## Notes

- Beads task: sdp-8y0y
- No new production code; tests only

---

## Execution Report

**Build:** 00-054-12 (sdp-8y0y)  
**Date:** 2026-02-09

### Steps

1. Pre-build: `hooks/pre-build.sh 00-054-12` â€” PASSED
2. Guard: `sdp guard activate 00-054-12` â€” activated
3. TDD: Added tests in emitter_test.go (EmitSync public API, Emit+waitForFile), tracer_test.go (FormatHuman keyData branches: gate_name, model_id, decision choice), writer_test.go (NewWriter empty path, Append when path is dir)
4. Post-build: skipped (no poetry/pyproject in repo)

### Results

- **Coverage:** 85.3% (was 74.0%) â€” AC4 met
- **Tests:** all pass (42 tests in evidence package)
- **Verdict:** âœ… COMPLETE
