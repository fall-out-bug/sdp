---
ws_id: "00-054-07"
feature_id: "F054"
title: "sdp log trace Command"
status: "backlog"
priority: "P0"
depends_on: ["00-054-04"]
blocks: ["00-054-09"]
project_id: "00"
---

# 00-054-07: sdp log trace Command

## Goal

CLI command to walk the evidence chain backwards from a commit/workstream and show what happened.

## Context

From VISION.md: "`sdp log trace <commit>` walks the evidence chain backwards." When something breaks in production, this answers "what AI agent did this, when, and what tests were run?"

## Acceptance Criteria

- [ ] AC1: `sdp log trace <commit-sha>` filters events by commit_sha
- [ ] AC2: `sdp log trace --ws <ws-id>` filters events by workstream
- [ ] AC3: Human-readable output: timeline with event type, timestamp, key data
- [ ] AC4: JSON output: `--json` flag for machine consumption
- [ ] AC5: Hash chain validation: `--verify` flag checks integrity
- [ ] AC6: Broken chain detection: reports first tampered/missing event
- [ ] AC7: `sdp log` (no subcommand) shows recent events (last 20)

## Scope Files

**Implementation:**
- sdp-plugin/cmd/sdp/log.go (new)
- sdp-plugin/internal/evidence/tracer.go (new)
- sdp-plugin/internal/evidence/tracer_test.go (new)

**Tests:**
- sdp-plugin/internal/evidence/tracer_test.go

## Output Format

```
$ sdp log trace abc123
Evidence trail for commit abc123:

  2026-02-08 14:32:01  plan         WS 00-054-03  scope: 4 files
  2026-02-08 14:35:12  generation   WS 00-054-03  model: claude-sonnet-4, 3 files changed
  2026-02-08 14:38:44  verification WS 00-054-03  PASS coverage: 87%
  2026-02-08 14:39:01  approval     WS 00-054-03  auto-approved (all gates green)

Chain integrity: ✓ valid (4 events, no breaks)
```

## Verification

```bash
cd sdp-plugin && go test ./internal/evidence/... -v -cover
# Manual: generate some events, run sdp log trace, verify output
```

## Notes

- ~1.5h work
- Uses evidence.Reader from WS-04
- Start with simple filters (commit, ws_id) — advanced queries later
- This is the "forensic trace" capability — simple but powerful
