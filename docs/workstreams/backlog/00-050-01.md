---
ws_id: 00-050-01
parent: sdp-79u
feature: F050
status: backlog
size: MEDIUM
project_id: 00
---

# Depends handled by parent epic sdp-79u
---

## WS-00-050-01: Go Project Setup + Core Parser

### ğŸ¯ Goal

Setup Go project structure, implement workstream YAML parser with frontmatter support. Foundation for all subsequent Go workstreams.

**What must WORK after completing this WS:**
- `go build ./cmd/sdp` produces executable binary
- `sdp --version` displays version string
- Parse workstream YAML with frontmatter correctly
- Validate workstream structure (ID format, capability tier)
- Return helpful error messages for invalid workstreams

**Acceptance Criteria:**
- [x] AC1: go build ./cmd/sdp produces executable binary without errors
- [x] AC2: sdp --version displays version string (e.g., "sdp version 1.0.0-dev")
- [x] AC3: Parse workstream YAML with frontmatter (--- delimited sections)
- [x] AC4: Validate workstream ID format (PP-FFF-SS regex: ^\d{2}-\d{3}-\d{2}$)
- [x] AC5: Validate capability tier (T0/T1/T2/T3 only valid values)
- [x] AC6: Parse acceptance_criteria, scope, goal fields from frontmatter
- [x] AC7: Return structured Go errors (not panics) for invalid YAML
- [ ] Coverage â‰¥ 80%
- [ ] mypy --strict passes (N/A for Go)

**âš ï¸ WS is NOT complete until Goal is achieved (all AC âœ…).**

---

### ğŸ“‹ Contracts

**Technical Constraints:**
- Must use `gopkg.in/yaml.v3` for YAML parsing
- Must use `bytes.SplitN` for frontmatter extraction
- Must return detailed validation errors with field name
- Must use regex for WS ID validation

---

### ğŸ”Œ Interfaces

```go
// Public API
package core

func ParseWorkstream(wsPath string) (*Workstream, error)
func (ws *Workstream) Validate() error

type Workstream struct {
    ID          string
    Feature     string
    Status      string
    Goal        string
    Acceptance []string
    Scope       Scope
}
```

---

### ğŸ“ Scope Files

**Implementation:**
- `cmd/sdp/main.go`
- `cmd/sdp/root.go`
- `internal/core/workstream.go`
- `internal/core/validator.go`
- `internal/core/schema.go`
- `go.mod`
- `go.sum`
- `Makefile`

**Tests:**
- `internal/core/workstream_test.go`
- `internal/core/validator_test.go`

---

### âœ… Testing

**Unit Tests:**
```bash
# Test valid workstream parsing
TestParseValidWorkstream()

# Test invalid WS ID format
TestValidateInvalidWSID()

# Test invalid capability tier
TestValidateInvalidTier()

# Test missing required fields
TestParseMissingRequiredFields()
```

**Integration Tests:**
```bash
# Build binary
go build ./cmd/sdp
./sdp --version

# Parse real workstream
go test ./internal/core/ -run TestParseRealWorkstream
```

---

### ğŸ” Verification

**Pre-build:**
- [ ] Review Go project structure matches design
- [ ] Verify gopkg.in/yaml.v3 dependency in go.mod
- [ ] Check regex for WS ID validation

**Post-build:**
```bash
# Run tests
go test ./internal/core/... -v -cover

# Build binary
go build ./cmd/sdp
./sdp --version

# Check binary size
ls -lh sdp  # Should be <5MB initially
```

---

### ğŸ“ Notes

**Dependencies:** None (foundation workstream)

**Context:**
This is the foundation workstream. All other Go workstreams depend on this.
Start with minimal setup, add features iteratively. Test with real workstreams
from `docs/workstreams/backlog/` to ensure compatibility.

**Key Decisions:**
- Use yaml.v3 (not yaml.v2) for better frontmatter support
- Regex validation at parse time (fail fast)
- Struct over map[string]any for type safety

**Risks:**
- YAML parsing edge cases (empty files, malformed YAML)
- Regex performance (compile once, reuse)

**Mitigations:**
- Comprehensive test coverage for edge cases
- Helpful error messages with line numbers
