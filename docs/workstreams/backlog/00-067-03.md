---
ws_id: 00-067-03
feature_id: F067
title: "Cursor/OpenCode Adapter Consistency"
status: backlog
priority: 0
size: SMALL
depends_on: [00-067-02]
blocks: [00-067-08]
project_id: sdp
---

## Goal

Ensure all tool adapters (Cursor, OpenCode, Claude) reference valid, canonical skill and agent paths.

## Context

`.opencode/opencode.json` references `prompts/commands/build.md` but the actual path is `prompts/skills/build/SKILL.md`. The OpenCode config defines only 5 agents (builder, reviewer, planner, deployer, orchestrator) while 25+ are available.

`.cursor/worktrees.json` references `poetry install` despite the project being Go-first.

## Acceptance Criteria

- [ ] AC1: Audit all adapter configs for broken/outdated references
- [ ] AC2: Fix `.opencode/opencode.json` agent prompt paths to use canonical `prompts/skills/`
- [ ] AC3: Add missing agent definitions to OpenCode config
- [ ] AC4: Fix `.cursor/worktrees.json` to reference Go setup instead of Poetry
- [ ] AC5: Add CI validation that adapter configs reference existing files
- [ ] AC6: Document adapter configuration patterns in `docs/reference/configuration.md`
- [ ] AC7: All adapter configs pass path validation without warnings

## Scope Files

```yaml
scope_files:
  - .opencode/opencode.json
  - .cursor/worktrees.json
  - .cursor/README.md
  - docs/reference/configuration.md
  - .github/workflows/go-ci.yml     # add adapter path validation step
```

## Implementation Notes

### Path Validation Script

For each adapter config:
1. Extract all file path references
2. Resolve relative paths from config location
3. Verify each target file exists
4. Report missing/broken references

### OpenCode Updates

Update agent prompt references:
- `prompts/commands/build.md` → `prompts/skills/build/SKILL.md`
- Add agents: security, sre, ci-reviewer, spec-reviewer, etc.

### Cursor Updates

Replace `poetry install` with Go-appropriate setup:
```json
{
  "setup_commands_unix": [
    "cd sdp-plugin && go mod download 2>/dev/null || echo 'Go modules not configured'",
    "echo '✅ Worktree ready'"
  ]
}
```

## Definition of Done

- [ ] All adapter path references resolve to existing files
- [ ] CI validates adapter consistency
- [ ] AC1-AC7 met
