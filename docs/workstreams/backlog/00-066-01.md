---
ws_id: 00-066-01
feature_id: F066
title: "Audit: Analyze Current CLI Coupling"
status: backlog
priority: 0
depends_on: []
blocks: [00-066-02, 00-066-03, 00-066-04]
project_id: sdp
---

## Goal

Audit all prompts/skills/agents to identify CLI dependencies and categorize by coupling level.

## Context

Part of F066 Protocol/Prompts Separation. Before we can decouple, we need to understand current coupling.

## Acceptance Criteria

- [ ] AC1: Inventory all CLI command references in prompts/
- [ ] AC2: Categorize by dependency level (required/optional/enhancement)
- [ ] AC3: Document which skills fail without CLI
- [ ] AC4: Identify minimum shell fallbacks needed
- [ ] AC5: Create coupling report in docs/reference/

## Scope Files

```yaml
scope_files:
  - docs/reference/cli-coupling-audit.md  # NEW - audit report
  - prompts/skills/**/*.md                 # ANALYZE
  - prompts/agents/**/*.md                 # ANALYZE
```

## Implementation Notes

### Dependency Levels

| Level | Description | Example |
|-------|-------------|---------|
| **REQUIRED** | Skill cannot work without CLI | `sdp drift detect` (needs parser) |
| **OPTIONAL** | Skill works but reduced functionality | `sdp guard context check` (can use git) |
| **ENHANCEMENT** | CLI improves but not required | `sdp memory search` (can grep) |

### Audit Process

1. Grep all `sdp ` command references in prompts/
2. For each command, determine:
   - What it does
   - Can shell equivalent exist?
   - What functionality is lost without CLI?
3. Generate report with recommendations

### Expected Findings

Based on quick scan:

| Skill | CLI Commands | Dependency |
|-------|--------------|------------|
| @build | sdp guard, sdp drift | OPTIONAL |
| @review | sdp contract validate | OPTIONAL |
| @oneshot | sdp guard, sdp drift | OPTIONAL |
| @deploy | git commands only | NONE |

Most skills use CLI for enhancement, not core functionality.

## Definition of Done

- [ ] All AC met
- [ ] Report documents all CLI references
- [ ] Priority list of fallbacks to implement
