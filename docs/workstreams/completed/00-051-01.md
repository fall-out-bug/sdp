---
ws_id: 00-051-01
feature_id: F051
title: "Memory Store: Artifact Indexer"
status: completed
priority: 0
depends_on: []
blocks: [00-051-02]
project_id: sdp
beads_id: sdp-6fx.11
---

## Goal

Implement artifact indexing system for Long-term Memory. Index all project artifacts (.md files, code files, decisions) into a searchable store.

## Context

Part of F051 Long-term Memory System. This is the foundation for hybrid search - we need to index artifacts before we can search them.

**Related Beads:** sdp-6fx.11 (Drift detection system)

## Acceptance Criteria

- [ ] AC1: Index all .md files in docs/ directory
- [ ] AC2: Extract metadata (title, tags, feature_id, ws_id)
- [ ] AC3: Store index in SQLite database at .sdp/memory.db
- [ ] AC4: Support incremental updates (only re-index changed files)
- [ ] AC5: Track file hashes for change detection

## Scope Files

```yaml
scope_files:
  - sdp-plugin/internal/memory/indexer.go      # NEW
  - sdp-plugin/internal/memory/indexer_test.go # NEW
  - sdp-plugin/internal/memory/store.go        # NEW
  - sdp-plugin/internal/memory/store_test.go   # NEW
  - sdp-plugin/cmd/sdp/memory.go               # NEW
```

## Implementation Notes

### Data Model

```go
type Artifact struct {
    ID          string    // hash of path
    Path        string    // relative path
    Type        string    // "doc", "code", "decision"
    Title       string    // extracted from frontmatter or first heading
    Content     string    // full text content
    Embedding   []float64 // cached embedding (nil if not computed)
    FeatureID   string    // extracted from frontmatter
    WorkstreamID string   // extracted from filename
    Tags        []string  // extracted from frontmatter
    FileHash    string    // SHA256 of file content
    IndexedAt   time.Time
}
```

### Indexing Strategy

1. Walk docs/ directory
2. Parse markdown files with frontmatter
3. Extract metadata (title, feature_id, ws_id, tags)
4. Store in SQLite with FTS5 virtual table
5. Track file hashes in .sdp/index_state.json

### Dependencies

- Existing: internal/parser (for frontmatter parsing)
- New: go-sqlite3 or modernc.org/sqlite (pure Go)

## Definition of Done

- [ ] All AC met
- [ ] Tests pass with â‰¥80% coverage
- [ ] CLI command: `sdp memory index`
- [ ] Documentation updated
