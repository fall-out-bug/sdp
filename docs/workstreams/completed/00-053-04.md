---
ws_id: "00-053-04"
feature_id: "F053"
title: "Workstream 00-053-04: Update @design Skill"
status: complete
priority: 2
size: MEDIUM
depends_on: []
blocks: []
---

# Workstream 00-053-04: Update @design Skill

**Feature:** F053 - Component Contract Validation
**Issue:** sdp-ie25.5
**Project ID:** 00
**Status:** Pending
**Priority:** P1

## Overview

Update the @design skill to add contract synthesis phase after workstream creation but before implementation begins. This is the critical integration point that ensures contracts are agreed upon BEFORE parallel execution.

## Problem Statement

Current @design workflow:
1. Creates workstreams
2. Organizes files
3. Defines Clean Architecture layers
4. DONE → Implementation begins

**Missing:**
- Contract synthesis phase
- Multi-agent agreement on integration points
- Contract lock before implementation
- Validation workstreams in the design

## Solution

Add Phase 5: Contract Synthesis to @design skill:
1. Call contract synthesis agent (WS 00-053-00)
2. Wait for multi-agent agreement
3. Lock contract (WS 00-053-06)
4. Add validation workstreams (WS 00-053-01, 00-053-02, 00-053-03)
5. Only then allow implementation to begin

## Acceptance Criteria

1. **@design skill updated** at `.claude/skills/design/SKILL.md`
2. New Phase 5: Contract Synthesis
3. Calls `sdp contract synthesize` after workstream creation
4. Waits for contract agreement
5. Calls `sdp contract lock` to freeze contract
6. Adds validation workstreams:
   - 00-FFF-Z1: Code analysis (extract contracts)
   - 00-FFF-Z2: Contract generation
   - 00-FFF-Z3: Contract validation
7. Updates @design documentation
8. Example output includes contract synthesis

## Scope

### In Scope
- @design skill modification
- Phase 5 addition
- Contract synthesis integration
- Validation workstream generation
- Documentation updates

### Out of Scope
- Contract synthesis agent (WS 00-053-00)
- Contract lock command (WS 00-053-06)
- Validation agents (WS 00-053-01, 00-053-02, 00-053-03)

## Implementation Approach

### Phase 1: Read Current @design
1. Read `.claude/skills/design/SKILL.md`
2. Understand current phases (1-4)
3. Identify insertion point for Phase 5

### Phase 2: Add Phase 5
1. Add new section after Phase 4
2. Define steps:
   - Call contract synthesis agent
   - Multi-agent review (parallel)
   - Conflict resolution
   - Contract lock
   - Add validation workstreams
3. Update phase count

### Phase 3: Update Documentation
1. Update workflow diagram
2. Update phase descriptions
3. Add example output with contract synthesis
4. Update decision tree

### Phase 4: Validation Workstream Generation
1. Create template for validation workstreams
2. Add to workstream generation logic
3. Assign Z1, Z2, Z3 IDs (after all feature workstreams)

## Dependencies

**UPSTREAM:**
- WS 00-053-00 (Contract synthesis agent must exist)
- WS 00-053-04 (Contract validation agent must exist)

**DOWNSTREAM:**
- None (this is integration work)

## Testing

### Integration Test
- Run @design on sample feature
- Verify Phase 5 executes
- Verify contract synthesis called
- Verify validation workstreams created
- Verify contract locked

### Manual Test
- Use @design to plan new feature
- Verify contract appears in `.contracts/`
- Verify workstreams include Z1, Z2, Z3

## Quality Gates

- Skill file < 200 LOC
- Clear instructions for AI agent
- Example output included
- Documentation updated

## Definition of Done

- [ ] All acceptance criteria met
- [ ] Phase 5 added to @design skill
- [ ] Contract synthesis integrated
- [ ] Validation workstreams generated
- [ ] Documentation updated
- [ ] Integration test passes
- [ ] Example output verified

## Notes

**Workflow Change:**

**Before:**
```
@design → Creates workstreams → DONE
```

**After:**
```
@design → Creates workstreams
         ↓
         Phase 5: Contract Synthesis
         ↓
         1. Analyze integration points
         2. Call synthesis agent
         3. Multi-agent review
         4. Resolve conflicts
         5. Lock contract
         6. Add validation workstreams
         ↓
         DONE → Implementation begins
```

**Validation Workstream IDs:**
- Feature workstreams: 00-FFF-01 to 00-FFF-30
- Validation workstreams: 00-FFF-Z1, Z2, Z3 (always last)
- This ensures validation runs after implementation

**Critical Insight:** This is the KEY integration point. Without this update, contract synthesis never happens automatically.

## Execution Report Template

```
**Started:** [Timestamp]
**Completed:** [Timestamp]
**Duration:** Xm

**Files Modified:**
- .claude/skills/design/SKILL.md (MODIFIED)
  - Added Phase 5: Contract Synthesis
  - Updated workflow diagram
  - Added example output
  - X lines added, Y lines removed

**Test Results:**
- Integration test: PASSED
- Manual test: PASSED
- @design creates validation workstreams: YES
- Contract synthesis called: YES

**Challenges:**
- [Any issues encountered]

**Follow-up Work:**
- [None - this is integration work]
```
