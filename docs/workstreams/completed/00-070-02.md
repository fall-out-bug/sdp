---
ws_id: 00-070-02
feature_id: F070
title: "Recovery Playbook Engine"
status: completed
priority: 0
size: MEDIUM
depends_on: [00-070-01]
blocks: [00-070-05]
project_id: sdp
completed_at: 2026-02-16
---

## Goal

Attach explicit recovery playbooks to failure classes and present them automatically.

## Context

Users need immediate actionable steps instead of generic "command failed" output.

## Acceptance Criteria

- [x] AC1: Define playbook schema keyed by error class/code
- [x] AC2: Implement lookup and rendering in failure flow
- [x] AC3: Include fast-path and deep-path recovery options
- [x] AC4: Support project-specific override hooks (via Register API)
- [x] AC5: Add tests for playbook selection and rendering

## Scope Files

```yaml
scope_files:
  - sdp-plugin/internal/recovery/playbook.go
  - sdp-plugin/internal/recovery/playbook_test.go
  - docs/reference/runbooks.md
```

## Implementation Summary

Created `internal/recovery` package with:
- Playbook struct with fast/deep path steps
- PlaybookRegistry with error code and class lookup
- 15 built-in playbooks for P0/P1 errors
- 5 class default playbooks
- FormatPlaybook for human-readable output
- 98.4% test coverage

## Definition of Done

- [x] Every P0/P1 failure class has a recovery playbook
- [x] Recovery instructions are surfaced inline in CLI output
- [x] AC1-AC5 complete
